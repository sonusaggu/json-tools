document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("json-input"),t=document.getElementById("yaml-output"),n=document.getElementById("convert-btn"),r=document.getElementById("download-yaml"),o=document.getElementById("copy-yaml"),a=document.getElementById("condense"),l=document.getElementById("indent"),i={apiVersion:"v1",kind:"Pod",metadata:{name:"nginx",labels:{app:"nginx",tier:"frontend"}},spec:{containers:[{name:"nginx",image:"nginx:1.14.2",ports:[{containerPort:80}]}]}};function d(){const t=e.value.split("\n");let n="";for(let e=0;e<t.length;e++)n+=e+1+"<br>";document.querySelector(".editor-wrapper .line-numbers").innerHTML=n}function c(){const e=t.textContent.split("\n");let n="";for(let t=0;t<e.length;t++)n+=t+1+"<br>";document.querySelector(".result-wrapper .output-line-numbers").innerHTML=n}document.getElementById("sample-data").addEventListener("click",()=>{e.value=JSON.stringify(i,null,2),d()}),document.getElementById("clear-input").addEventListener("click",()=>{e.value="",t.textContent="YAML data will appear here...",d(),c()}),n.addEventListener("click",()=>{if(!e.value.trim())return t.textContent="Error: Please enter JSON data first",void c();const n=function(e,t=!0,n=2){try{if(!e.trim())throw new Error("Input is empty");const r=JSON.parse(e);return jsyaml.dump(r,{indent:n,flowLevel:t?-1:0,skipInvalid:!0,lineWidth:-1})}catch(e){return`Error: ${e.message}\n\nPlease check:\n1. Valid JSON format\n2. No trailing commas\n3. Properly quoted property names`}}(e.value,a.checked,parseInt(l.value));t.textContent=n,c()}),r.addEventListener("click",()=>{const e=t.textContent;if(e&&!e.startsWith("Error:"))try{const t=new Blob([e],{type:"text/yaml"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=`converted_${(new Date).getTime()}.yaml`,document.body.appendChild(r),r.click(),setTimeout(()=>{document.body.removeChild(r),URL.revokeObjectURL(n)},100)}catch(e){console.error("Download failed:",e),alert("Download failed: "+e.message)}else alert("Please generate valid YAML first")}),o.addEventListener("click",()=>{const e=t.textContent;e&&!e.startsWith("Error:")?navigator.clipboard.writeText(e).then(()=>{const e=o.querySelector("i");e.classList.replace("far","fas"),setTimeout(()=>e.classList.replace("fas","far"),2e3)}).catch(e=>{console.error("Copy failed:",e),alert("Failed to copy YAML to clipboard")}):alert("Please generate valid YAML first")}),e.addEventListener("input",d),d(),c()});